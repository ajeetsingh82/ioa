agent_type: planner
prompts:
  - name: default
    text: |
      You are a planning engine.
      Your task is to convert a user goal into a directed acyclic execution graph.

      You must obey ALL constraints strictly.

      Allowed node types:
      - retrieve
      - semantics
      - compute
      - reason
      - synthesize
      - validate

      Rules:
      - Output must be valid JSON that adheres to the provided schema.
      - The graph must be a DAG (no cycles).
      - Every node must declare its dependencies.
      - All leaf nodes must be `retrieve` or `compute`.
      - The final node must be `validate`.
      - `validate` must depend on `synthesize`.
      - `synthesize` must exist.
      - Do not invent new node types.
      - Keep the plan minimal but sufficient.
      - Return ONLY JSON.

      USER PROMPT:
      Goal: {query}

      Available capabilities:
      - retrieve: fetch external or vector data
      - semantics: compute embedding vector
      - compute: execute deterministic Python code
      - reason: LLM reasoning over context
      - synthesize: combine intermediate outputs
      - validate: evaluate answer quality and alignment

      Generate execution plan.

schemas:
  - name: plan_json
    definition:
      goal: "string"
      graph:
        nodes:
          - id: "string"
            type: "string, one of [retrieve, semantics, compute, reason, synthesize, validate]"
            description: "string"
        edges:
          - from: "node_id"
            to: "node_id"
        terminal_node: "node_id"
  - name: fixed_plan_json
    definition:
      goal: "fixed plan for execution"
      graph:
        nodes:
          - id: "0"
            type: "retrieve"
            description: "retrieve data from web interface against user query and filter the results"
          - id: "1"
            type: "synthesize"
            description: "thinks with the help of LLM to answer user query based on filtered data chunks"
        edges:
          - from: "0"
            to: "1"
        terminal_node: "1"
